<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Profile</title>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/jquery.validation/1.19.5/jquery.validate.min.js"></script>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

<style>
:root{--sidebar-width:170px;--sidebar-collapsed-width:75px;--layout-gap:16px;}
body{background:#f8f9fa;overflow-x:hidden;}

.sidebar{width:var(--sidebar-width);height:100vh;position:fixed;background:#fff;border-right:1px solid #dee2e6;padding:20px 12px;}
.sidebar.collapsed{width:var(--sidebar-collapsed-width);}
.sidebar.collapsed .link-text,.sidebar.collapsed h4{display:none;}
.sidebar .nav-link{padding:12px 15px;border-radius:8px;margin-bottom:6px;display:flex;color:#495057;}
.sidebar .nav-link.active{background:#0d6efd;color:#fff;}

.navbar{margin-left:calc(var(--sidebar-width)+var(--layout-gap));}
.content{margin-left:calc(var(--sidebar-width)+var(--layout-gap));padding:20px;}
.collapsed-margin{margin-left:calc(var(--sidebar-collapsed-width)+var(--layout-gap))!important;}

@media(max-width:991px){.navbar,.content{margin-left:0!important}.sidebar{left:-100%}.sidebar.mobile-show{left:0}}

.profile-card{border-radius:20px;border:none}
.profile-header{background:linear-gradient(135deg,#0d6efd,#00d4ff);height:120px}
.profile-img{width:120px;height:120px;object-fit:cover;border:5px solid #fff;border-radius:50%;margin-top:-60px}

label.error{font-size:13px;color:#dc3545;margin-top:5px}

.dark-mode{background:#121212;color:#e0e0e0;}
.dark-mode .sidebar,.dark-mode .navbar,.dark-mode .card{background:#1a1a1a;color:#e6e6e6;border-color:#2c2c2c;}
</style>
</head>

<body>

<!-- SIDEBAR -->
<div class="sidebar" id="sidebar">
<h4 class="px-3 mb-4 text-primary fw-bold">Admin</h4>
<a href="profile.html" class="nav-link"><i class="bi bi-person"></i><span class="link-text ms-2">Profile</span></a>
</div>

<!-- NAVBAR -->
<nav class="navbar sticky-top bg-white shadow-sm px-3 py-2" id="navbar">
<div class="container-fluid">
<button class="btn btn-light border" id="toggle-btn"><i class="bi bi-list"></i></button>
<button class="btn btn-light border ms-2" onclick="toggleDark()">
<i id="darkIcon" class="bi bi-moon-stars"></i>
</button>
</div>
</nav>

<!-- CONTENT -->
<div class="content">
<div class="container py-4">
<div class="row justify-content-center">
<div class="col-lg-8">

<div class="card profile-card shadow">
<div class="profile-header"></div>

<div class="card-body text-center">

<img id="displayPic" src="sandiyo.jpg" class="profile-img">

<h3 id="displayName" class="fw-bold mt-3">Admin User</h3>
<p class="text-muted">System Administrator</p>

<div class="row text-start g-4 my-4">
<div class="col-md-6">
<label>Email</label>
<div id="displayEmail" class="fw-bold">admin@mail.com</div>
</div>
<div class="col-md-6">
<label>Phone</label>
<div id="displayPhone" class="fw-bold">+91 0000000000</div>
</div>
</div>

<button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#editProfileModal">
Edit Profile
</button>

<button class="btn btn-dark ms-2" data-bs-toggle="modal" data-bs-target="#passwordModal">
Change Password
</button>

</div>
</div>

</div>
</div>
</div>
</div>

<!-- EDIT MODAL -->
<div class="modal fade" id="editProfileModal">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header bg-primary text-white">
<h5>Edit Profile</h5>
<button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
</div>
<div class="modal-body">
<form id="editForm">
<input id="editName" name="editName" class="form-control mb-3" placeholder="Name">
<input id="editEmail" name="editEmail" class="form-control mb-3" placeholder="Email">
<input id="editPhone" name="editPhone" class="form-control" placeholder="Phone">
</form>
</div>
<div class="modal-footer">
<button class="btn btn-primary" onclick="updateProfile()">Save</button>
</div>
</div>
</div>
</div>

<!-- PASSWORD MODAL -->
<div class="modal fade" id="passwordModal">
<div class="modal-dialog modal-sm">
<div class="modal-content">
<div class="modal-header bg-dark text-white">
<h5>Password</h5>
<button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
</div>
<div class="modal-body">
<form id="passForm">
<input id="newPass" name="newPass" type="password" class="form-control mb-3" placeholder="New password">
<input id="confirmPass" name="confirmPass" type="password" class="form-control" placeholder="Confirm password">
</form>
</div>
<div class="modal-footer">
<button class="btn btn-dark w-100" onclick="updatePassword()">Update</button>
</div>
</div>
</div>
</div>

<!-- TOAST -->
<div class="toast position-fixed bottom-0 end-0 m-3" id="toast">
<div class="toast-body bg-success text-white">Saved successfully</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
/* ===== VALIDATION ===== */
$.validator.addMethod("matchPass", v=>v===newPass.value);

$("#editForm").validate({
rules:{
editName:{required:true,minlength:3},
editEmail:{required:true,email:true},
editPhone:{required:true,minlength:10,digits:true}
},
errorClass:"is-invalid",
validClass:"is-valid"
});

$("#passForm").validate({
rules:{
newPass:{required:true,minlength:6},
confirmPass:{required:true,matchPass:true}
},
errorClass:"is-invalid",
validClass:"is-valid"
});

/* ===== STORAGE ===== */
function loadProfile(){
let p=JSON.parse(localStorage.profile||"{}");
if(!p.name) return;
displayName.innerText=p.name;
displayEmail.innerText=p.email;
displayPhone.innerText=p.phone;
editName.value=p.name;
editEmail.value=p.email;
editPhone.value=p.phone;
}
loadProfile();

/* ===== ACTIONS ===== */
function updateProfile(){
if(!$("#editForm").valid()) return;

let p={
name:editName.value,
email:editEmail.value,
phone:editPhone.value
};
localStorage.profile=JSON.stringify(p);
loadProfile();

bootstrap.Modal.getInstance(editProfileModal).hide();
new bootstrap.Toast(toast).show();
}

function updatePassword(){
if(!$("#passForm").valid()) return;
bootstrap.Modal.getInstance(passwordModal).hide();
passForm.reset();
new bootstrap.Toast(toast).show();
}

/* ===== SIDEBAR ===== */
toggleBtn.onclick=()=>{
if(innerWidth<992){sidebar.classList.toggle("mobile-show");return;}
sidebar.classList.toggle("collapsed");
navbar.classList.toggle("collapsed-margin");
content.classList.toggle("collapsed-margin");
};

/* ===== DARK MODE ===== */
if(localStorage.theme==="dark"){
document.body.classList.add("dark-mode");
darkIcon.className="bi bi-sun";
}
function toggleDark(){
document.body.classList.toggle("dark-mode");
localStorage.theme=document.body.classList.contains("dark-mode")?"dark":"light";
darkIcon.className=document.body.classList.contains("dark-mode")?"bi bi-sun":"bi bi-moon-stars";
}

/* ===== ACTIVE LINK ===== */
let cur=location.pathname.split("/").pop();
document.querySelectorAll(".sidebar a").forEach(a=>{
if(a.getAttribute("href")===cur) a.classList.add("active");
});
</script>

</body>
</html>
